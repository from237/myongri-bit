<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>명리BTI - 나와 우주가 만나는 순간</title>
  <!-- Google Fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@300;400;500;700&display=swap" rel="stylesheet" />
  <style>
    /* 기존 스타일 그대로 유지 */
    :root { --bg-color:#1a1a2e; --primary-color:#16213e; --secondary-color:#0f3460; --accent-color:#e94560; --text-color:#dcdcdc; --light-text-color:#a4a4b3; --card-bg:#1f2847; }
    *{margin:0;padding:0;box-sizing:border-box;}
    html,body{height:100%;width:100%;}
    body{font-family:'Noto Sans KR',sans-serif;background:var(--bg-color);color:var(--text-color);display:flex;justify-content:center;align-items:center;padding:1rem;}
    .container{width:100%;max-width:480px;height:100%;max-height:800px;background:var(--primary-color);border-radius:20px;box-shadow:0 10px 30px rgba(0,0,0,0.3);display:flex;flex-direction:column;overflow:hidden;}
    .page{display:none;flex-direction:column;justify-content:space-between;align-items:center;text-align:center;padding:2rem;height:100%;overflow-y:auto;animation:fadeIn .5s ease-in-out;}
    .page.active{display:flex;}
    @keyframes fadeIn{from{opacity:0;transform:translateY(10px);}to{opacity:1;transform:translateY(0);}}
    header,main,footer{width:100%;}
    .btn{background:var(--accent-color);color:#fff;border:none;border-radius:50px;padding:1rem 2rem;font-size:1.1rem;font-weight:700;cursor:pointer;transition:.3s;box-shadow:0 4px 15px rgba(233,69,96,0.4);}
    .btn:hover{transform:translateY(-3px);box-shadow:0 6px 20px rgba(233,69,96,0.6);}
    /* ... 기타 스타일 유지 ... */
  </style>
</head>
<body>
  <div class="container">
    <div id="main-page" class="page active">
      <header><h1>명리BTI</h1><p class="subtitle">MBTI와 사주팔자로 알아보는<br>진짜 내 모습 이야기</p></header>
      <main>
        <div class="main-image"><img src="https://placehold.co/200x200/1a1a2e/e94560?text=✨" alt="명리BTI"></div>
        <div class="intro-text"><p>MBTI 결과만으로 부족했다면,<br>수천 년의 지혜와 만나 보세요!</p></div>
      </main>
      <footer><button id="start-btn" class="btn">테스트 시작</button></footer>
    </div>
    <div id="test-page" class="page">
      <header><div class="progress-bar"><div id="progress" class="progress"></div></div></header>
      <main><div id="question-container" class="question-card"></div></main>
      <footer></footer>
    </div>
    <div id="loading-page" class="page"><main><div class="loader"></div><p>당신의 우주를 분석하는 중...</p></main></div>
    <div id="result-page" class="page">
      <header><h2 id="result-title"></h2></header>
      <main>
        <section class="result-section"><h3 id="result-synergy-title"></h3><p id="result-synergy-text"></p></section>
        <section class="result-section"><h3 id="result-clash-title"></h3><p id="result-clash-text"></p></section>
        <section class="result-section"><h3 id="result-advice-title"></h3><p id="result-advice-text"></p></section>
        <section class="result-section"><h3 id="result-gunghap-title"></h3><p id="result-gunghap-text"></p></section>
      </main>
      <footer><a href="#" id="restart-btn" class="restart-button">테스트 다시하기</a></footer>
    </div>
  </div>
  <script>
    window.addEventListener('DOMContentLoaded', () => {
      // 요소 캡처
      const pages = document.querySelectorAll('.page');
      const questionContainer = document.getElementById('question-container');
      const progressBar = document.getElementById('progress');
      const startBtn = document.getElementById('start-btn');
      const restartBtn = document.getElementById('restart-btn');
      // 데이터 및 상태
      const questions = [ /* MBTI 10문항 배열 */ ];
      const birthQuestion = { q:'거의 다 왔어요!', sub_q:'생년월일과 시간을 알려주세요.' };
      const resultsData = { /* 모든 조합 매핑 */ };
      let currentQuestionIndex = 0;
      let userAnswers = { E:0,I:0,S:0,N:0,T:0,F:0,J:0,P:0 };
      // 페이지 전환
      function showPage(id){ pages.forEach(p=>p.classList.remove('active')); document.getElementById(id).classList.add('active'); }
      // 진행바
      function updateProgressBar(){ const total=questions.length+1; progressBar.style.width=`${(currentQuestionIndex/total)*100}%`; }
      // 질문 표시
      function displayQuestion(){
        if(currentQuestionIndex<questions.length){
          const q=questions[currentQuestionIndex];
          questionContainer.innerHTML = `<h3>Q${currentQuestionIndex+1}. ${q.q}</h3>`+
            q.a.map(ans=>`<button class="answer-btn" data-type="${ans.type}">${ans.text}</button>`).join('');
          document.querySelectorAll('.answer-btn').forEach(btn=>btn.addEventListener('click',handleAnswer));
        } else displayBirthQuestion();
        updateProgressBar();
      }
      function handleAnswer(e){ userAnswers[e.target.dataset.type]++; currentQuestionIndex++; displayQuestion(); }
      function displayBirthQuestion(){
        questionContainer.innerHTML = `<h3>${birthQuestion.q}</h3><p>${birthQuestion.sub_q}</p>`+
          `<div class="birth-input"><label>생년월일</label><input type="date" id="birthdate"></div>`+
          `<div class="birth-input"><label>시간</label><input type="time" id="birthtime"></div>`+
          `<button id="submit-btn" class="btn">결과 분석하기</button>`;
        document.getElementById('submit-btn').addEventListener('click',handleSubmit);
        updateProgressBar();
      }
      function handleSubmit(){
        const bd=document.getElementById('birthdate').value;
        const bt=document.getElementById('birthtime').value;
        if(!bd||!bt){alert('생년월일과 시간을 입력해주세요!');return;}        
        showPage('loading-page');
        calculateAndShowResult(bd,bt);
      }
      function resetTest(){ currentQuestionIndex=0; userAnswers={E:0,I:0,S:0,N:0,T:0,F:0,J:0,P:0}; updateProgressBar(); showPage('main-page'); }
      // 이벤트
      startBtn.addEventListener('click',()=>{ showPage('test-page'); displayQuestion(); });
      restartBtn.addEventListener('click',e=>{ e.preventDefault(); resetTest(); });
      // calculateAndShowResult 등 나머지 함수 정의 유지
    });
  </script>
</body>
</html>
