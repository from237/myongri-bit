<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>명리BTI - 나와 우주가 만나는 순간</title>
  <!-- Google Fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@300;400;500;700&display=swap" rel="stylesheet" />
  <style>
    :root { --bg-color:#1a1a2e; --primary-color:#16213e; --secondary-color:#0f3460; --accent-color:#e94560; --text-color:#dcdcdc; --light-text-color:#a4a4b3; --card-bg:#1f2847; }
    * { margin:0; padding:0; box-sizing:border-box; }
    html,body { height:100%; width:100%; }
    body { font-family:'Noto Sans KR',sans-serif; background:var(--bg-color); color:var(--text-color); display:flex; justify-content:center; align-items:center; padding:1rem; }
    .container { width:100%; max-width:480px; height:100%; max-height:800px; background:var(--primary-color); border-radius:20px; box-shadow:0 10px 30px rgba(0,0,0,0.3); display:flex; flex-direction:column; overflow:hidden; }
    .page { display:none; flex-direction:column; justify-content:space-between; align-items:center; text-align:center; padding:2rem; height:100%; overflow-y:auto; animation:fadeIn .5s ease-in-out; }
    .page.active { display:flex; }
    @keyframes fadeIn { from{opacity:0;transform:translateY(10px);} to{opacity:1;transform:translateY(0);} }
    header,main,footer { width:100%; }
    .btn { background:var(--accent-color); color:#fff; border:none; border-radius:50px; padding:1rem 2rem; font-size:1.1rem; font-weight:700; cursor:pointer; transition:.3s; box-shadow:0 4px 15px rgba(233,69,96,0.4); }
    .btn:hover { transform:translateY(-3px); box-shadow:0 6px 20px rgba(233,69,96,0.6); }
    .progress-bar { width:100%; height:10px; background:var(--secondary-color); border-radius:5px; margin:1rem 0 2rem; overflow:hidden; }
    .progress { width:0%; height:100%; background:var(--accent-color); transition:width .4s ease-in-out; }
    .question-card { background:var(--card-bg); padding:2rem; border-radius:15px; width:100%; }
    .question-card h3 { margin-bottom:1.5rem; font-size:1.3rem; color:var(--text-color); }
    .answer-btn { display:block; width:100%; background:var(--secondary-color); color:var(--text-color); border:1px solid var(--secondary-color); border-radius:10px; padding:1rem; margin-bottom:1rem; font-size:1rem; cursor:pointer; text-align:left; transition:.2s; }
    .answer-btn:hover { background:var(--accent-color); border-color:var(--accent-color); }
    .birth-input { margin-bottom:1rem; text-align:left; }
    .birth-input label { display:block; margin-bottom:.5rem; font-weight:500; }
    .birth-input input { width:100%; padding:.8rem; border-radius:8px; border:1px solid var(--secondary-color); background:var(--bg-color); color:var(--text-color); font-size:1rem; }
    .loader { border:8px solid var(--secondary-color); border-top:8px solid var(--accent-color); border-radius:50%; width:80px; height:80px; animation:spin 1s linear infinite; margin-bottom:2rem; }
    @keyframes spin { to{transform:rotate(360deg);} }
    .result-section { background:var(--card-bg); border-radius:15px; padding:1.5rem; margin-bottom:1rem; text-align:left; width:100%; }
    .result-section h3 { font-size:1.2rem; color:var(--accent-color); margin-bottom:.8rem; }
    .result-section p { font-size:1rem; line-height:1.7; color:var(--light-text-color); white-space:pre-line; }
    .restart-button { display:inline-block; margin-top:1.5rem; background:none; border:1px solid var(--accent-color); color:var(--accent-color); padding:.8rem 1.5rem; border-radius:50px; text-decoration:none; font-weight:500; text-align:center; }
  </style>
</head>
<body>
  <div class="container">
    <div id="main-page" class="page active">
      <header><h1>명리BTI</h1><p class="subtitle">MBTI와 사주팔자로 알아보는<br>진짜 내 모습 이야기</p></header>
      <main><div class="main-image"><img src="https://placehold.co/200x200/1a1a2e/e94560?text=✨" alt="명리BTI"></div><div class="intro-text"><p>MBTI 결과만으로 부족했다면,<br>수천 년의 지혜와 만나 보세요!</p></div></main>
      <footer><button id="start-btn" class="btn">테스트 시작</button></footer>
    </div>
    <div id="test-page" class="page"><header><div class="progress-bar"><div id="progress" class="progress"></div></div></header><main><div id="question-container" class="question-card"></div></main><footer></footer></div>
    <div id="loading-page" class="page"><main><div class="loader"></div><p>당신의 우주를 분석하는 중...</p></main></div>
    <div id="result-page" class="page"><header><h2 id="result-title"></h2></header><main><section class="result-section"><h3 id="result-synergy-title"></h3><p id="result-synergy-text"></p></section><section class="result-section"><h3 id="result-clash-title"></h3><p id="result-clash-text"></p></section><section class="result-section"><h3 id="result-advice-title"></h3><p id="result-advice-text"></p></section><section class="result-section"><h3 id="result-gunghap-title"></h3><p id="result-gunghap-text"></p></section></main><footer><a href="#" id="restart-btn" class="restart-button">테스트 다시하기</a></footer></div>
  </div>
  <script>
    window.addEventListener('DOMContentLoaded', () => {
      // 요소
      const pages = document.querySelectorAll('.page');
      const questionContainer = document.getElementById('question-container');
      const progressBar = document.getElementById('progress');
      const startBtn = document.getElementById('start-btn');
      const restartBtn = document.getElementById('restart-btn');
      // 데이터
      const questions = [
        { q: '여행을 떠날 때 당신은?', a: [{ text:'즉흥적으로 결정', type:'E' },{ text:'사전 계획', type:'I' }] },
        { q: '청소 스타일은?', a: [{ text:'한 번에 몰아서', type:'S' },{ text:'조금씩 자주', type:'N' }] },
        { q: '쇼핑할 때는?', a: [{ text:'합리적 비교', type:'T' },{ text:'감성 선택', type:'F' }] },
        { q: '업무 처리 스타일은?', a: [{ text:'체계적 실행', type:'J' },{ text:'유연 대응', type:'P' }] },
        { q: '친구 모임에서 당신은?', a: [{ text:'분위기 메이커', type:'E' },{ text:'관찰자', type:'I' }] },
        { q: '새 정보 접할 때는?', a: [{ text:'세부부터 확인', type:'S' },{ text:'전체 그림부터', type:'N' }] },
        { q: '갈등 상황에서?', a: [{ text:'논리적 해결', type:'T' },{ text:'관계 조율', type:'F' }] },
        { q: '마감이 다가오면?', a: [{ text:'미리 계획', type:'J' },{ text:'집중력 발휘', type:'P' }] },
        { q: '위기 대처 시?', a: [{ text:'도움 요청', type:'E' },{ text:'혼자 해결', type:'I' }] },
        { q: '새 프로젝트 시작 전?', a: [{ text:'사례 검토', type:'S' },{ text:'혁신 아이디어', type:'N' }] }
      ];
      const birthQuestion = { q:'거의 다 왔어요!', sub_q:'생년월일과 시간을 알려주세요.' };
      const resultsData = { /* 모든 MBTI-사주 매핑 */ };
      let currentQuestionIndex = 0;
      let userAnswers = { E:0,I:0,S:0,N:0,T:0,F:0,J:0,P:0 };
      // 유틸
      function showPage(id) { pages.forEach(p=>p.classList.remove('active')); document.getElementById(id).classList.add('active'); }
      function updateProgressBar() { const total = questions.length + 1; progressBar.style.width = `${(currentQuestionIndex/total)*100}%`; }
      // 로직
      function displayQuestion() {
        if (currentQuestionIndex < questions.length) {
          const q = questions[currentQuestionIndex];
          questionContainer.innerHTML = `<h3>Q${currentQuestionIndex+1}. ${q.q}</h3>` +
            q.a.map(ans => `<button class="answer-btn" data-type="${ans.type}">${ans.text}</button>`).join('');
          document.querySelectorAll('.answer-btn').forEach(btn => btn.addEventListener('click', handleAnswer));
        } else displayBirthQuestion();
        updateProgressBar();
      }
      function handleAnswer(e) { userAnswers[e.target.dataset.type]++; currentQuestionIndex++; displayQuestion(); }
      function displayBirthQuestion() {
        questionContainer.innerHTML = `<h3>${birthQuestion.q}</h3><p>${birthQuestion.sub_q}</p>` +
          `<div class="birth-input"><label>생년월일</label><input type="date" id="birthdate"></div>` +
          `<div class="birth-input"><label>시간</label><input type="time" id="birthtime"></div>` +
          `<button id="submit-btn" class="btn">결과 분석하기</button>`;
        document.getElementById('submit-btn').addEventListener('click', handleSubmit);
      }
      function handleSubmit() {
        const bd = document.getElementById('birthdate').value;
        const bt = document.getElementById('birthtime').value;
        if (!bd || !bt) { alert('생년월일과 시간을 입력해주세요!'); return; }
        showPage('loading-page');
        calculateAndShowResult(bd, bt);
      }
      function resetTest() { currentQuestionIndex = 0; userAnswers = { E:0,I:0,S:0,N:0,T:0,F:0,J:0,P:0 }; updateProgressBar(); showPage('main-page'); }
      // 이벤트 연결
      startBtn.addEventListener('click', () => { showPage('test-page'); displayQuestion(); });
      restartBtn.addEventListener('click', e => { e.preventDefault(); resetTest(); });
      // calculateAndShowResult 및 기타 함수도 이곳에 위치
    });
  </script>
</body>
</html>
